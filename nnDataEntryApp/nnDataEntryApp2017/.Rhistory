type  = 1)
dateValue <- '2018-03-16'
timeValue_sunrise <- '05:18'
timeValue_sunset <- '17:16'
coord(
as.POSIXct(paste(dateValue, timeValue_sunrise)),
as.POSIXct(paste(dateValue, timeValue_sunset)),
type  = 1)
dateValue <- '2018-03-16'
timeValue_sunrise <- '06:18'
timeValue_sunset <- '18:16'
as.POSIXct(paste(dateValue, timeValue_sunrise))
?coords
?coord
time1 <- as.POSIXct(paste(dateValue, timeValue_sunrise, 'EST'))
time2 <- as.POSIXct(paste(dateValue, timeValue_sunset, 'EST'))
time1
time2
dateValue <- '2018-03-16'
timeValue_sunrise <- '06:19'
timeValue_sunset <- '18:16'
time1 <- as.POSIXct(paste(dateValue, timeValue_sunrise, 'EST'))
time2 <- as.POSIXct(paste(dateValue, timeValue_sunset, 'EST'))
coord(time1, time2, type = 1)
time1 <- as.POSIXct(paste(dateValue, timeValue_sunrise, 'EDT'))
time2 <- as.POSIXct(paste(dateValue, timeValue_sunset, 'EDT'))
coord(time1, time2, type = 1)
time2
time2 - 5
time2 - 5*60*60
coord(time1 - 5*60*60, time2 - 5*60*60, type = 1)
coord(time1 + 5*60*60, time2 + 5*60*60, type = 1)
coord(time1 + 5*60*60-1, time2 + 5*60*60-1, type = 1)
coord(time1 - 5*60*60-1, time2 - 5*60*60-1, type = 1)
hoopoe2$tFirst[1]
time1 <- as.POSIXct(hoopoe2$tFirst[1], tz = "EST")
time2 <- as.POSIXct(hoopoe2$tSecond[2], tz = "EST")
coord(time1 - 5*60*60-1, time2 - 5*60*60-1, type = 1)
coord(time1, time2, type = 1)
time1
as.POSIXct(paste(dateValue, timeValue_sunrise), tz = 'EST')
time1 <- as.POSIXct(paste(dateValue, timeValue_sunrise), tz = 'EST')
time2 <- as.POSIXct(paste(dateValue, timeValue_sunset), tz = 'EST')
coord(time1, time2, type = 1)
time2
time1 <- as.POSIXct(paste(dateValue, timeValue_sunrise), tz = 'EDT')
time2 <- as.POSIXct(paste(dateValue, timeValue_sunset), tz = 'EDT')
coord(time1, time2, type = 1)
dateValue <- '2018-03-16'
timeValue_sunrise <- '07:19'
timeValue_sunset <- '19:16'
time1 <- as.POSIXct(paste(dateValue, timeValue_sunrise), tz = 'EST')
time2 <- as.POSIXct(paste(dateValue, timeValue_sunset), tz = 'EST')
coord(time1, time2, type = 1)
dateValue <- '2018-03-16'
timeValue_sunrise <- '07:19'
timeValue_sunset <- '19:16'
time1 <- as.POSIXct(paste(dateValue, timeValue_sunrise), tz = 'EDT')
time2 <- as.POSIXct(paste(dateValue, timeValue_sunset), tz = 'EDT')
coord(time1, time2, type = 1)
time1 <- as.POSIXct(paste(dateValue, timeValue_sunrise)-60*60, tz = 'EDT')
time2 <- as.POSIXct(paste(dateValue, timeValue_sunset)-60*60, tz = 'EDT')
coord(time1, time2, type = 1)
dateValue <- '2018-03-16'
timeValue_sunrise <- '06:19'
timeValue_sunset <- '18:16'
time1 <- as.POSIXct(paste(dateValue, timeValue_sunrise), tz = 'EST')
time2 <- as.POSIXct(paste(dateValue, timeValue_sunset)0, tz = 'EST')
time1 <- as.POSIXct(paste(dateValue, timeValue_sunrise), tz = 'EST')
time2 <- as.POSIXct(paste(dateValue, timeValue_sunset), tz = 'EST')
coord(time1, time2, type = 1)
coord
solar
rise <- as.POSIXct(paste(dateValue, timeValue_sunrise), tz = 'EST')
set <- as.POSIXct(paste(dateValue, timeValue_sunset), tz = 'EST')
rad <- pi/180
sr <- solar(rise)
sr
ss <- solar(set)
ss
cosz <- cos(rad * (90 - degElevation))
cosz <- cos(rad * (90 - 0))
cosz
lon <- -(sr$solarTime + ss$solarTime + ifelse(sr$solarTime <
ss$solarTime, 360, 0))/2
lon
lon <- (lon + 180)%%360 - 180
lon
hourAngle <- sr$solarTime + lon - 180
hourAngle
a <- sr$sinSolarDec
b <- sr$cosSolarDec * cos(rad * hourAngle)
a
b
x <- (a * cosz - sign(a) * b * suppressWarnings(sqrt(a^2 +
b^2 - cosz^2)))/(a^2 + b^2)
x
lat1 <- ifelse(abs(a) > tol, asin(x)/rad, NA)
tol <- 0
lat1 <- ifelse(abs(a) > tol, asin(x)/rad, NA)
lat1
hourAngle <- ss$solarTime + lon - 180
hourAngle
a <- ss$sinSolarDec
b <- ss$cosSolarDec * cos(rad * hourAngle)
a
b
x <- (a * cosz - sign(a) * b * suppressWarnings(sqrt(a^2 +
b^2 - cosz^2)))/(a^2 + b^2)
x
lat2 <- ifelse(abs(a) > tol, asin(x)/rad, NA)
lat2
rowMeans(cbind(lat1, lat2)
, nar.rm = TRUE)
rowMeans(cbind(lat1, lat2))
rise <- as.POSIXct(paste(dateValue, timeValue_sunrise), tz = 'EDT')
set <- as.POSIXct(paste(dateValue, timeValue_sunset), tz = 'EDT')
rad <- pi/180
sr <- solar(rise)
ss <- solar(set)
cosz <- cos(rad * (90 - 0))
lon <- -(sr$solarTime + ss$solarTime + ifelse(sr$solarTime <
ss$solarTime, 360, 0))/2
lon <- (lon + 180)%%360 - 180
hourAngle <- sr$solarTime + lon - 180
a <- sr$sinSolarDec
b <- sr$cosSolarDec * cos(rad * hourAngle)
x <- (a * cosz - sign(a) * b * suppressWarnings(sqrt(a^2 +
b^2 - cosz^2)))/(a^2 + b^2)
lat1 <- ifelse(abs(a) > tol, asin(x)/rad, NA)
hourAngle <- ss$solarTime + lon - 180
a <- ss$sinSolarDec
b <- ss$cosSolarDec * cos(rad * hourAngle)
x <- (a * cosz - sign(a) * b * suppressWarnings(sqrt(a^2 +
b^2 - cosz^2)))/(a^2 + b^2)
lat2 <- ifelse(abs(a) > tol, asin(x)/rad, NA)
out <- cbind(lon = lon, lat = rowMeans(cbind(lat1, lat2), na.rm = TRUE))
out
rise <- as.POSIXct(paste(dateValue, timeValue_sunrise), tz = 'EST')-60*60
rise
set <- as.POSIXct(paste(dateValue, timeValue_sunset), tz = 'EST')-60*60
set
rad <- pi/180
sr <- solar(rise)
ss <- solar(set)
cosz <- cos(rad * (90 - 0))
lon <- -(sr$solarTime + ss$solarTime + ifelse(sr$solarTime <
ss$solarTime, 360, 0))/2
lon <- (lon + 180)%%360 - 180
hourAngle <- sr$solarTime + lon - 180
a <- sr$sinSolarDec
b <- sr$cosSolarDec * cos(rad * hourAngle)
x <- (a * cosz - sign(a) * b * suppressWarnings(sqrt(a^2 +
b^2 - cosz^2)))/(a^2 + b^2)
lat1 <- ifelse(abs(a) > tol, asin(x)/rad, NA)
hourAngle <- ss$solarTime + lon - 180
a <- ss$sinSolarDec
b <- ss$cosSolarDec * cos(rad * hourAngle)
x <- (a * cosz - sign(a) * b * suppressWarnings(sqrt(a^2 +
b^2 - cosz^2)))/(a^2 + b^2)
lat2 <- ifelse(abs(a) > tol, asin(x)/rad, NA)
out <- cbind(lon = lon, lat = rowMeans(cbind(lat1, lat2), na.rm = TRUE))
out
rise <- as.POSIXct(paste(dateValue, timeValue_sunrise), tz = 'EST')
set <- as.POSIXct(paste(dateValue, timeValue_sunset), tz = 'EST')
rad <- pi/180
sr <- solar(rise)
ss <- solar(set)
cosz <- cos(rad * (90 - 0))
lon <- -(sr$solarTime + ss$solarTime + ifelse(sr$solarTime <
ss$solarTime, 360, 0))/2
lon <- (lon + 180)%%360 - 180
hourAngle <- sr$solarTime + lon - 180
a <- sr$sinSolarDec
b <- sr$cosSolarDec * cos(rad * hourAngle)
x <- (a * cosz - sign(a) * b * suppressWarnings(sqrt(a^2 +
b^2 - cosz^2)))/(a^2 + b^2)
lat1 <- ifelse(abs(a) > tol, asin(x)/rad, NA)
hourAngle <- ss$solarTime + lon - 180
a <- ss$sinSolarDec
b <- ss$cosSolarDec * cos(rad * hourAngle)
x <- (a * cosz - sign(a) * b * suppressWarnings(sqrt(a^2 +
b^2 - cosz^2)))/(a^2 + b^2)
lat2 <- ifelse(abs(a) > tol, asin(x)/rad, NA)
out <- cbind(lon = lon, lat = rowMeans(cbind(lat1, lat2), na.rm = TRUE))
out
timeValue_sunrise <- '05:50'
timeValue_sunset <- '20:45'
tol <- 0
dateValue <- '2018-03-16'
timeValue_sunrise <- '05:50'
timeValue_sunset <- '20:45'
tol <- 0
rise <- as.POSIXct(paste(dateValue, timeValue_sunrise), tz = 'EST')
set <- as.POSIXct(paste(dateValue, timeValue_sunset), tz = 'EST')
rad <- pi/180
sr <- solar(rise)
ss <- solar(set)
cosz <- cos(rad * (90 - 0))
lon <- -(sr$solarTime + ss$solarTime + ifelse(sr$solarTime <
ss$solarTime, 360, 0))/2
lon <- (lon + 180)%%360 - 180
hourAngle <- sr$solarTime + lon - 180
a <- sr$sinSolarDec
b <- sr$cosSolarDec * cos(rad * hourAngle)
x <- (a * cosz - sign(a) * b * suppressWarnings(sqrt(a^2 +
b^2 - cosz^2)))/(a^2 + b^2)
lat1 <- ifelse(abs(a) > tol, asin(x)/rad, NA)
hourAngle <- ss$solarTime + lon - 180
a <- ss$sinSolarDec
b <- ss$cosSolarDec * cos(rad * hourAngle)
x <- (a * cosz - sign(a) * b * suppressWarnings(sqrt(a^2 +
b^2 - cosz^2)))/(a^2 + b^2)
lat2 <- ifelse(abs(a) > tol, asin(x)/rad, NA)
cbind(lon = lon, lat = rowMeans(cbind(lat1, lat2), na.rm = TRUE))
dateValue <- '2018-03-16'
timeValue_sunrise <- '06:21'
timeValue_sunset <- '20:14'
tol <- 0
rise <- as.POSIXct(paste(dateValue, timeValue_sunrise), tz = 'EST')
set <- as.POSIXct(paste(dateValue, timeValue_sunset), tz = 'EST')
rad <- pi/180
sr <- solar(rise)
ss <- solar(set)
cosz <- cos(rad * (90 - 0))
lon <- -(sr$solarTime + ss$solarTime + ifelse(sr$solarTime <
ss$solarTime, 360, 0))/2
lon <- (lon + 180)%%360 - 180
hourAngle <- sr$solarTime + lon - 180
a <- sr$sinSolarDec
b <- sr$cosSolarDec * cos(rad * hourAngle)
x <- (a * cosz - sign(a) * b * suppressWarnings(sqrt(a^2 +
b^2 - cosz^2)))/(a^2 + b^2)
lat1 <- ifelse(abs(a) > tol, asin(x)/rad, NA)
hourAngle <- ss$solarTime + lon - 180
a <- ss$sinSolarDec
b <- ss$cosSolarDec * cos(rad * hourAngle)
x <- (a * cosz - sign(a) * b * suppressWarnings(sqrt(a^2 +
b^2 - cosz^2)))/(a^2 + b^2)
lat2 <- ifelse(abs(a) > tol, asin(x)/rad, NA)
cbind(lon = lon, lat = rowMeans(cbind(lat1, lat2), na.rm = TRUE))
dateValue <- '2018-03-16'
timeValue_sunrise <- '07:19'
timeValue_sunset <- '19:16'
tol <- 0
rise <- as.POSIXct(paste(dateValue, timeValue_sunrise), tz = 'EST')
set <- as.POSIXct(paste(dateValue, timeValue_sunset), tz = 'EST')
rad <- pi/180
sr <- solar(rise)
ss <- solar(set)
cosz <- cos(rad * (90 - 0))
lon <- -(sr$solarTime + ss$solarTime + ifelse(sr$solarTime <
ss$solarTime, 360, 0))/2
lon <- (lon + 180)%%360 - 180
hourAngle <- sr$solarTime + lon - 180
a <- sr$sinSolarDec
b <- sr$cosSolarDec * cos(rad * hourAngle)
x <- (a * cosz - sign(a) * b * suppressWarnings(sqrt(a^2 +
b^2 - cosz^2)))/(a^2 + b^2)
lat1 <- ifelse(abs(a) > tol, asin(x)/rad, NA)
hourAngle <- ss$solarTime + lon - 180
a <- ss$sinSolarDec
b <- ss$cosSolarDec * cos(rad * hourAngle)
x <- (a * cosz - sign(a) * b * suppressWarnings(sqrt(a^2 +
b^2 - cosz^2)))/(a^2 + b^2)
lat2 <- ifelse(abs(a) > tol, asin(x)/rad, NA)
cbind(lon = lon, lat = rowMeans(cbind(lat1, lat2), na.rm = TRUE))
dateValue <- '2018-03-16'
timeValue_sunrise <- '07:19'
timeValue_sunset <- '19:16'
tol <- 0
rise <- as.POSIXct(paste(dateValue, timeValue_sunrise), tz = 'EST')-60*60
set <- as.POSIXct(paste(dateValue, timeValue_sunset), tz = 'EST')-60*60
rad <- pi/180
sr <- solar(rise)
ss <- solar(set)
cosz <- cos(rad * (90 - 0))
lon <- -(sr$solarTime + ss$solarTime + ifelse(sr$solarTime <
ss$solarTime, 360, 0))/2
lon <- (lon + 180)%%360 - 180
hourAngle <- sr$solarTime + lon - 180
a <- sr$sinSolarDec
b <- sr$cosSolarDec * cos(rad * hourAngle)
x <- (a * cosz - sign(a) * b * suppressWarnings(sqrt(a^2 +
b^2 - cosz^2)))/(a^2 + b^2)
lat1 <- ifelse(abs(a) > tol, asin(x)/rad, NA)
hourAngle <- ss$solarTime + lon - 180
a <- ss$sinSolarDec
b <- ss$cosSolarDec * cos(rad * hourAngle)
x <- (a * cosz - sign(a) * b * suppressWarnings(sqrt(a^2 +
b^2 - cosz^2)))/(a^2 + b^2)
lat2 <- ifelse(abs(a) > tol, asin(x)/rad, NA)
cbind(lon = lon, lat = rowMeans(cbind(lat1, lat2), na.rm = TRUE))
sr
ss
lon <- -(sr$solarTime + ss$solarTime + ifelse(sr$solarTime < ss$solarTime, 360, 0))/2
lon
(lon + 180)%%360 - 180
a <- sr$sinSolarDec
a
b <- sr$cosSolarDec * cos(rad * hourAngle)
b
(a * cosz - sign(a) * b * suppressWarnings(sqrt(a^2 +  b^2 - cosz^2)))/(a^2 + b^2)
x <- (a * cosz - sign(a) * b * suppressWarnings(sqrt(a^2 +  b^2 - cosz^2)))/(a^2 + b^2)
lat1 <- ifelse(abs(a) > tol, asin(x)/rad, NA)
lat1
tol <- .2
rise <- as.POSIXct(paste(dateValue, timeValue_sunrise), tz = 'EST')-60*60
set <- as.POSIXct(paste(dateValue, timeValue_sunset), tz = 'EST')-60*60
rad <- pi/180
sr <- solar(rise)
ss <- solar(set)
cosz <- cos(rad * (90 - 0))
lon <- -(sr$solarTime + ss$solarTime + ifelse(sr$solarTime < ss$solarTime, 360, 0))/2
lon <- (lon + 180)%%360 - 180
hourAngle <- sr$solarTime + lon - 180
a <- sr$sinSolarDec
b <- sr$cosSolarDec * cos(rad * hourAngle)
x <- (a * cosz - sign(a) * b * suppressWarnings(sqrt(a^2 +  b^2 - cosz^2)))/(a^2 + b^2)
lat1 <- ifelse(abs(a) > tol, asin(x)/rad, NA)
hourAngle <- ss$solarTime + lon - 180
a <- ss$sinSolarDec
b <- ss$cosSolarDec * cos(rad * hourAngle)
x <- (a * cosz - sign(a) * b * suppressWarnings(sqrt(a^2 +
b^2 - cosz^2)))/(a^2 + b^2)
lat2 <- ifelse(abs(a) > tol, asin(x)/rad, NA)
cbind(lon = lon, lat = rowMeans(cbind(lat1, lat2), na.rm = TRUE))
tol <- .1
rise <- as.POSIXct(paste(dateValue, timeValue_sunrise), tz = 'EST')-60*60
set <- as.POSIXct(paste(dateValue, timeValue_sunset), tz = 'EST')-60*60
rad <- pi/180
sr <- solar(rise)
ss <- solar(set)
cosz <- cos(rad * (90 - 0))
lon <- -(sr$solarTime + ss$solarTime + ifelse(sr$solarTime < ss$solarTime, 360, 0))/2
lon <- (lon + 180)%%360 - 180
hourAngle <- sr$solarTime + lon - 180
a <- sr$sinSolarDec
b <- sr$cosSolarDec * cos(rad * hourAngle)
x <- (a * cosz - sign(a) * b * suppressWarnings(sqrt(a^2 +  b^2 - cosz^2)))/(a^2 + b^2)
lat1 <- ifelse(abs(a) > tol, asin(x)/rad, NA)
hourAngle <- ss$solarTime + lon - 180
a <- ss$sinSolarDec
b <- ss$cosSolarDec * cos(rad * hourAngle)
x <- (a * cosz - sign(a) * b * suppressWarnings(sqrt(a^2 +
b^2 - cosz^2)))/(a^2 + b^2)
lat2 <- ifelse(abs(a) > tol, asin(x)/rad, NA)
cbind(lon = lon, lat = rowMeans(cbind(lat1, lat2), na.rm = TRUE))
dateValue <- '2018-03-16'
timeValue_sunrise <- '07:19'
timeValue_sunset <- '19:16'
tol <- .01
rise <- as.POSIXct(paste(dateValue, timeValue_sunrise), tz = 'EST')-60*60
set <- as.POSIXct(paste(dateValue, timeValue_sunset), tz = 'EST')-60*60
rad <- pi/180
sr <- solar(rise)
ss <- solar(set)
cosz <- cos(rad * (90 - 0))
lon <- -(sr$solarTime + ss$solarTime + ifelse(sr$solarTime < ss$solarTime, 360, 0))/2
lon <- (lon + 180)%%360 - 180
hourAngle <- sr$solarTime + lon - 180
a <- sr$sinSolarDec
b <- sr$cosSolarDec * cos(rad * hourAngle)
x <- (a * cosz - sign(a) * b * suppressWarnings(sqrt(a^2 +  b^2 - cosz^2)))/(a^2 + b^2)
lat1 <- ifelse(abs(a) > tol, asin(x)/rad, NA)
hourAngle <- ss$solarTime + lon - 180
a <- ss$sinSolarDec
b <- ss$cosSolarDec * cos(rad * hourAngle)
x <- (a * cosz - sign(a) * b * suppressWarnings(sqrt(a^2 +
b^2 - cosz^2)))/(a^2 + b^2)
lat2 <- ifelse(abs(a) > tol, asin(x)/rad, NA)
cbind(lon = lon, lat = rowMeans(cbind(lat1, lat2), na.rm = TRUE))
coord
dateValue <- '2018-03-16'
timeValue_sunrise <- '06:18'
timeValue_sunset <- '18:16'
tol <- .01
rise <- as.POSIXct(paste(dateValue, timeValue_sunrise), tz = 'EST')#-60*60
set <- as.POSIXct(paste(dateValue, timeValue_sunset), tz = 'EST')#-60*60
rad <- pi/180
sr <- solar(rise)
ss <- solar(set)
cosz <- cos(rad * (90 - 0))
lon <- -(sr$solarTime + ss$solarTime + ifelse(sr$solarTime < ss$solarTime, 360, 0))/2
lon <- (lon + 180)%%360 - 180
hourAngle <- sr$solarTime + lon - 180
a <- sr$sinSolarDec
b <- sr$cosSolarDec * cos(rad * hourAngle)
x <- (a * cosz - sign(a) * b * suppressWarnings(sqrt(a^2 +  b^2 - cosz^2)))/(a^2 + b^2)
lat1 <- ifelse(abs(a) > tol, asin(x)/rad, NA)
cbind(lon = lon, lat = rowMeans(cbind(lat1, lat2), na.rm = TRUE))
solar(rise)
solar(set)
dateValue <- '2018-03-16'
timeValue_sunrise <- '06:18'
timeValue_sunset <- '18:16'
rise <- as.POSIXct(paste(dateValue, timeValue_sunrise), tz = 'EST')#-60*60
set <- as.POSIXct(paste(dateValue, timeValue_sunset), tz = 'EST')#-60*60
rad <- pi/180
sr <- solar(rise)
ss <- solar(set)
cosz <- cos(rad * (90 - 0))
lon <- -(sr$solarTime + ss$solarTime + ifelse(sr$solarTime < ss$solarTime, 360, 0))/2
lon <- (lon + 180)%%360 - 180
hourAngle <- sr$solarTime + lon - 180
a <- sr$sinSolarDec
b <- sr$cosSolarDec * cos(rad * hourAngle)
x <- (a * cosz - sign(a) * b * suppressWarnings(sqrt(a^2 +  b^2 - cosz^2)))/(a^2 + b^2)
lat <- asin(x)/rad
cbind(lon, lat)
lon
sr
hourAngle <- sr$solarTime + lon - 180
hourAngle
lon <- -(sr$solarTime + ss$solarTime + ifelse(sr$solarTime < ss$solarTime, 360, 0))/2
lon <- (lon + 180)%%360 - 180
# Latitude
hourAngle <- abs(sr$solarTime + lon - 180)
a <- sr$sinSolarDec
b <- sr$cosSolarDec * cos(rad * hourAngle)
x <- (a * cosz - sign(a) * b * suppressWarnings(sqrt(a^2 +  b^2 - cosz^2)))/(a^2 + b^2)
lat <- asin(x)/rad
cbind(lon, lat)
hourAngle <- sr$solarTime + lon - 180
hourAngle
sr$sinSolarDec
sr
solor(rise)
solar(rise)
?solar
rad
a
b
hourAngle <- sr$solarTime + lon - 180
a <- sr$sinSolarDec
b <- sr$cosSolarDec * cos(rad * hourAngle)
x <- (a * cosz - sign(a) * b * suppressWarnings(sqrt(a^2 +  b^2 - cosz^2)))/(a^2 + b^2)
lat <- asin(x)/rad
cbind(lon, lat)
dateValue <- '2018-03-16'
timeValue_sunrise <- '07:18'
timeValue_sunset <- '19:16'
rise <- as.POSIXct(paste(dateValue, timeValue_sunrise), tz = 'EST')#-60*60
set <- as.POSIXct(paste(dateValue, timeValue_sunset), tz = 'EST')#-60*60
# Set up:
rad <- pi/180
sr <- solar(rise)
ss <- solar(set)
cosz <- cos(rad * (90 - 0))
# Longitude:
lon <- -(sr$solarTime + ss$solarTime + ifelse(sr$solarTime < ss$solarTime, 360, 0))/2
lon <- (lon + 180)%%360 - 180
# Latitude:
hourAngle <- sr$solarTime + lon - 180
a <- sr$sinSolarDec
b <- sr$cosSolarDec * cos(rad * hourAngle)
x <- (a * cosz - sign(a) * b * suppressWarnings(sqrt(a^2 +  b^2 - cosz^2)))/(a^2 + b^2)
lat <- asin(x)/rad
# Coordinate output:
cbind(lon, lat)
dateValue <- '2018-03-16'
timeValue_sunrise <- '06:18'
timeValue_sunset <- '18:16'
rise <- as.POSIXct(paste(dateValue, timeValue_sunrise), tz = 'EST')#-60*60
set <- as.POSIXct(paste(dateValue, timeValue_sunset), tz = 'EST')#-60*60
# Set up:
rad <- pi/180
sr <- solar(rise)
ss <- solar(set)
cosz <- cos(rad * (90 - 0))
# Longitude:
lon <- -(sr$solarTime + ss$solarTime + ifelse(sr$solarTime < ss$solarTime, 360, 0))/2
lon <- (lon + 180)%%360 - 180
# Latitude:
hourAngle <- sr$solarTime + lon - 180
a <- sr$sinSolarDec
b <- sr$cosSolarDec * cos(rad * hourAngle)
x <- (a * cosz - sign(a) * b * suppressWarnings(sqrt(a^2 +  b^2 - cosz^2)))/(a^2 + b^2)
lat <- asin(x)/rad
# Coordinate output:
cbind(lon, lat)
hourAngle <- sr$solarTime + lon - 180
hourAngle
rad
hourAngle <- sr$solarTime + lon - 180
a <- sr$sinSolarDec
b <- sr$cosSolarDec * cos(rad * hourAngle)
sr$cosSolarDec * cos(rad * hourAngle)
sr$cosSolarDec * cos(rad * -1*hourAngle)
cos(rad)
cos(-rad)
lat
lat*4
se
sr
hourAngle <- sr$solarTime + lon - 180
a <- sr$sinSolarDec
b <- sr$cosSolarDec * cos(rad * hourAngle)
x <- (a * cosz - sign(a) * b * sqrt(a^2 +  b^2 - cosz^2))/(a^2 + b^2)
lat <- asin(x)/rad
cbind(lon, lat)
hourAnge*4/1400
hourAngle*4/1400
abs(hourAngle*4/1400)
?cos
solar(rise)
acos(solar(rise)$cosSolarDec)
asin(solar(rise)$sinSolarDec)
sin(solar(rise)$sinSolarDec)
co(solar(rise)$sinSolarDec)
cos(solar(rise)$sinSolarDec)
?solar
